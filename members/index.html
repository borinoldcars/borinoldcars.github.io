<!doctype html>
<html lang="fr"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Annuaire des membres · Borin'Old Cars</title>
<meta name="robots" content="noindex">
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:#f8f9fb;margin:24px}
.container{max-width:1100px;margin:auto;background:#fff;padding:16px 20px;border-radius:16px;box-shadow:0 8px 20px rgba(0,0,0,.06)}
.bar{display:flex;justify-content:space-between;gap:12px;align-items:center;margin-bottom:8px}
.btn{background:#0d6efd;color:#fff;text-decoration:none;padding:10px 14px;border-radius:10px;font-weight:600}
.btn:hover{filter:brightness(.95)}
.top{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
input[type="search"]{flex:1;min-width:240px;padding:10px 12px;border:1px solid #ddd;border-radius:10px}
.filters label{margin-right:10px}
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
th{background:#f6f8fb}
.count{color:#555;font-size:14px}

/* Écran de verrouillage */
.locked .protected{filter:blur(6px);pointer-events:none;user-select:none}
#gate{
  position:fixed;
  inset:0;
  z-index:9999;
  background:rgba(248,249,251,.96);
  display:none;
  align-items:center;
  justify-content:center;
  padding:16px
}
.locked #gate{display:flex}
.gcard{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:22px;max-width:420px;width:100%;box-shadow:0 8px 20px rgba(0,0,0,.08)}
.gcard h2{margin:0 0 8px 0}
.grow{display:flex;gap:8px;margin-top:12px}
.grow input{flex:1;padding:10px 12px;border:1px solid #ddd;border-radius:10px}
.grow button{background:#0d6efd;color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer}
#err{color:#b42318;font-size:14px;margin-top:8px;display:none}
</style></head>
<body>
<div id="gate">
  <div class="gcard">
    <h2>Accès réservé</h2>
    <p>Entrez le code pour accéder à l'annuaire des membres.</p>
    <div class="grow">
      <input id="code" type="password" placeholder="Code d'accès">
      <button id="go">Entrer</button>
    </div>
    <div id="err">Code incorrect.</div>
  </div>
</div>

<div class="container protected">
  <div class="bar">
    <h1>Annuaire des membres</h1>
    <div style="display:flex; gap:8px;">
      <a class="btn" href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTD6oJpza2MevO_5zSaKDXqdljiJZeBedGow3MROmJqIz6_r_TT8kt4Xz-TWIPxHY3ChG4dqKo7z5gt/pub?gid=27480806&amp;single=true&amp;output=csv" target="_blank" rel="noopener">Ouvrir le Google Sheet</a>
      <a class="btn" id="logout" href="#">Se déconnecter</a>
    </div>
  </div>

  <div class="top">
    <input id="q" type="search" placeholder="Rechercher par nom, véhicule…">
    <div class="filters">
      <label><input type="radio" name="cot" value="all" checked> Tous</label>
      <label><input type="radio" name="cot" value="oui"> Cotisation OK</label>
      <label><input type="radio" name="cot" value="non"> Cotisation NON</label>
    </div>
    <div class="count"><span id="count">0</span>/<span id="total">0</span> membres</div>
  </div>

  <table>
    <thead><tr><th>Nom</th><th>Véhicule</th><th>Cotisation</th><th></th></tr></thead>
    <tbody id="rows">
      <tr data-name='Patrice  Colmant' data-veh='Renault  16 TL Automatic' data-cot='oui'><td><a href='colmant-patrice.html'>Patrice  Colmant</a></td><td>Renault  16 TL Automatic</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='colmant-patrice.html'>Ouvrir</a></td></tr>
<tr data-name='Olivier Jeunieaux' data-veh='VW Passat B35I' data-cot='oui'><td><a href='jeunieaux-olivier.html'>Olivier Jeunieaux</a></td><td>VW Passat B35I</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='jeunieaux-olivier.html'>Ouvrir</a></td></tr>
<tr data-name='Frédéric Grasso' data-veh='BMW 318is' data-cot='oui'><td><a href='grasso-frederic.html'>Frédéric Grasso</a></td><td>BMW 318is</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='grasso-frederic.html'>Ouvrir</a></td></tr>
<tr data-name='Emmanuël  Saussez' data-veh='Alfa Roméo  Giulia 1300ti' data-cot='oui'><td><a href='saussez-emmanuel.html'>Emmanuël  Saussez</a></td><td>Alfa Roméo  Giulia 1300ti</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='saussez-emmanuel.html'>Ouvrir</a></td></tr>
<tr data-name='Marc  Jeunieaux' data-veh='Vw Golf 2' data-cot='oui'><td><a href='jeunieaux-marc.html'>Marc  Jeunieaux</a></td><td>Vw Golf 2</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='jeunieaux-marc.html'>Ouvrir</a></td></tr>
<tr data-name='Pierre Vanhollebeke' data-veh='Citroën AMI8' data-cot='oui'><td><a href='vanhollebeke-pierre.html'>Pierre Vanhollebeke</a></td><td>Citroën AMI8</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='vanhollebeke-pierre.html'>Ouvrir</a></td></tr>
<tr data-name='Jean Mottry' data-veh='Opel  Rekord' data-cot='non'><td><a href='mottry-jean.html'>Jean Mottry</a></td><td>Opel  Rekord</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#FDECEC;color:#B42318;font-weight:600'>Non</span></td><td><a href='mottry-jean.html'>Ouvrir</a></td></tr>
<tr data-name='Steven Heyckmans' data-veh='Citroën 2 CV' data-cot='oui'><td><a href='heyckmans-steven.html'>Steven Heyckmans</a></td><td>Citroën 2 CV</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='heyckmans-steven.html'>Ouvrir</a></td></tr>
<tr data-name='Claude Denis' data-veh='Porsche  996 4S' data-cot='oui'><td><a href='denis-claude.html'>Claude Denis</a></td><td>Porsche  996 4S</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='denis-claude.html'>Ouvrir</a></td></tr>
<tr data-name='Fabrice knippenberg' data-veh='Lotus Catheram' data-cot='oui'><td><a href='knippenberg-fabrice.html'>Fabrice knippenberg</a></td><td>Lotus Catheram</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='knippenberg-fabrice.html'>Ouvrir</a></td></tr>
<tr data-name='Philippe Bonnot' data-veh='Opel Calibra' data-cot='oui'><td><a href='bonnot-philippe.html'>Philippe Bonnot</a></td><td>Opel Calibra</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#EAF7EA;color:#0F6D0F;font-weight:600'>Oui</span></td><td><a href='bonnot-philippe.html'>Ouvrir</a></td></tr>
<tr data-name='Olivier Glineur' data-veh='Pontiac Cheftain Catalina' data-cot='non'><td><a href='glineur-olivier.html'>Olivier Glineur</a></td><td>Pontiac Cheftain Catalina</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#FDECEC;color:#B42318;font-weight:600'>Non</span></td><td><a href='glineur-olivier.html'>Ouvrir</a></td></tr>
<tr data-name='Hugo Grasso' data-veh='Fiat 127' data-cot='non'><td><a href='grasso-hugo.html'>Hugo Grasso</a></td><td>Fiat 127</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#FDECEC;color:#B42318;font-weight:600'>Non</span></td><td><a href='grasso-hugo.html'>Ouvrir</a></td></tr>
<tr data-name='Henri Lagniau' data-veh='Renault Super 5 GT Turbo' data-cot='non'><td><a href='lagniau-henri.html'>Henri Lagniau</a></td><td>Renault Super 5 GT Turbo</td><td><span style='display:inline-block;padding:4px 10px;border-radius:999px;background:#FDECEC;color:#B42318;font-weight:600'>Non</span></td><td><a href='lagniau-henri.html'>Ouvrir</a></td></tr>
    </tbody>
  </table>
</div>

<script>
// Empreinte SHA-256 du code (côté build)
const EXPECTED = "58c2eaf78e8ac6ab1e4cc85e332c15446b8a7771947fc073a5bbc2c400aab0a2";

// Reset via URL : .../members/?logout=1
if (new URLSearchParams(location.search).get('logout') === '1') {
  localStorage.removeItem('members_access');
}

function setLocked(on){ document.body.classList.toggle('locked', !!on); }
function savedOK(){
  const s = localStorage.getItem('members_access');
  return s && EXPECTED && s === EXPECTED;
}

async function sha256(txt){
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(txt));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

async function tryUnlock(){
  const input = document.getElementById('code');
  const err = document.getElementById('err');
  const h = await sha256((input.value||'').trim());
  if(h === EXPECTED){
    localStorage.setItem('members_access', h);
    err.style.display = 'none';
    setLocked(false);
  }else{
    err.style.display = 'block';
    input.select();
  }
}

(function initGate(){
  if(!EXPECTED){ setLocked(false); }           // pas de code → pas de verrou
  else if(savedOK()){ setLocked(false); }      // déjà autorisé
  else { setLocked(true); }                    // afficher le portail

  const go = document.getElementById('go');
  const code = document.getElementById('code');
  if(go) go.addEventListener('click', tryUnlock);
  if(code) code.addEventListener('keydown', e=>{ if(e.key==='Enter') tryUnlock(); });

  const logoutBtn = document.getElementById('logout');
  if (logoutBtn){
    logoutBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      localStorage.removeItem('members_access');
      location.reload();
    });
  }
})();

// Recherche / filtres
const q = document.getElementById('q');
const rows = Array.from(document.querySelectorAll('#rows tr'));
const radios = Array.from(document.querySelectorAll('input[name="cot"]'));
const countEl = document.getElementById('count');
const totalEl = document.getElementById('total');
totalEl.textContent = rows.length;

function apply(){
  const term = (q.value||'').trim().toLowerCase();
  const cot = (document.querySelector('input[name="cot"]:checked')||{}).value || 'all';
  let shown = 0;
  rows.forEach(tr=>{
    const name = tr.dataset.name.toLowerCase();
    const veh = tr.dataset.veh.toLowerCase();
    const scot = tr.dataset.cot;
    const okTerm = !term || name.includes(term) || veh.includes(term);
    const okCot = cot === 'all' || scot === cot;
    tr.style.display = (okTerm && okCot) ? '' : 'none';
    if(okTerm && okCot) shown++;
  });
  countEl.textContent = shown;
}
q.addEventListener('input', apply);
radios.forEach(r=>r.addEventListener('change', apply));
apply();
</script>
</body></html>